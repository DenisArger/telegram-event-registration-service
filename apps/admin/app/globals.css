@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light;
  --bg: 243 246 252;
  --surface: 255 255 255;
  --surface-elevated: 255 255 255;
  --text: 15 23 42;
  --muted: 71 85 105;
  --border: 203 213 225;
  --accent: 14 116 144;
  --success: 22 163 74;
  --danger: 220 38 38;
  --ring: 14 116 144;
}

:root[data-theme="dark"] {
  color-scheme: dark;
  --bg: 3 7 18;
  --surface: 15 23 42;
  --surface-elevated: 30 41 59;
  --text: 226 232 240;
  --muted: 148 163 184;
  --border: 51 65 85;
  --accent: 34 211 238;
  --success: 74 222 128;
  --danger: 248 113 113;
  --ring: 34 211 238;
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    color-scheme: dark;
    --bg: 3 7 18;
    --surface: 15 23 42;
    --surface-elevated: 30 41 59;
    --text: 226 232 240;
    --muted: 148 163 184;
    --border: 51 65 85;
    --accent: 34 211 238;
    --success: 74 222 128;
    --danger: 248 113 113;
    --ring: 34 211 238;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html,
  body {
    @apply min-h-full;
  }

  body {
    @apply overflow-x-hidden bg-bg text-text antialiased;
    font-family: "IBM Plex Sans", "Segoe UI", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;
  }

  h1 {
    @apply text-3xl font-semibold leading-tight tracking-tight;
  }

  h2 {
    @apply text-2xl font-semibold leading-tight tracking-tight;
  }

  h3 {
    @apply text-lg font-semibold leading-snug;
  }

  p {
    @apply text-sm leading-relaxed text-muted;
  }

  a {
    @apply text-accent underline-offset-2 transition-colors hover:text-accent/80;
  }

  button,
  input,
  select,
  textarea {
    @apply text-sm;
    font-family: inherit;
  }

  button {
    @apply inline-flex items-center justify-center rounded-lg border border-border bg-surface px-3 py-2 text-text transition hover:bg-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/70 disabled:cursor-not-allowed disabled:opacity-60;
  }

  input,
  select,
  textarea {
    @apply w-full rounded-lg border border-border bg-surface px-3 py-2 text-text placeholder:text-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/60;
  }

  table {
    @apply w-full border-collapse;
  }

  th,
  td {
    @apply border border-border px-3 py-2 align-top text-sm;
  }

  th {
    @apply bg-surface-elevated text-left font-semibold text-text;
  }
}

@layer components {
  .page-shell {
    @apply min-h-screen overflow-x-hidden;
  }

  .page-content {
    @apply mx-auto w-full max-w-[1280px] px-4 py-6 sm:px-6 lg:px-8;
  }

  .page-stack {
    @apply grid gap-5;
  }

  .section-grid {
    @apply page-stack;
  }

  .card {
    @apply panel;
  }

  .panel {
    @apply rounded-2xl border border-border bg-surface p-5 shadow-panel;
  }

  .panel-compact {
    @apply rounded-xl border border-border bg-surface p-4;
  }

  .toolbar-grid {
    @apply grid gap-3 md:grid-cols-2;
  }

  .attendees-toolbar {
    @apply md:grid-cols-2 xl:grid-cols-[minmax(280px,1fr)_minmax(280px,1fr)_auto] xl:items-end;
  }

  .attendees-panel {
    @apply mx-auto w-full max-w-[1220px];
  }

  .attendees-toolbar-switch {
    @apply flex w-full items-end justify-start md:col-span-2 xl:col-span-1;
  }

  .attendees-toolbar-controls {
    @apply grid w-full gap-2 sm:w-auto 2xl:grid-cols-2;
  }

  .inline-field {
    @apply grid gap-1.5;
  }

  .inline-field > span,
  .event-selector > span {
    @apply text-xs font-semibold uppercase tracking-wide text-muted;
  }

  .event-selector {
    @apply inline-field;
  }

  .quick-links {
    @apply grid gap-3 sm:grid-cols-2 xl:grid-cols-3;
  }

  .quick-link-card {
    @apply panel-compact transition-transform duration-150 hover:-translate-y-0.5;
  }

  .attendees-view-switch {
    @apply inline-flex w-fit shrink-0 rounded-xl border border-border bg-surface p-1;
  }

  .attendees-view-switch a {
    @apply rounded-lg px-2.5 py-1.5 text-xs no-underline transition sm:text-sm;
  }

  .attendees-view-switch a.active {
    @apply bg-accent/10 text-text;
  }

  .attendees-density-switch {
    @apply inline-flex w-fit shrink-0 rounded-xl border border-border bg-surface p-1;
  }

  .attendees-density-switch a {
    @apply rounded-lg px-2.5 py-1.5 text-xs no-underline transition sm:text-sm;
  }

  .attendees-density-switch a.active {
    @apply bg-accent/10 text-text;
  }

  .attendees-table-wrap {
    @apply max-w-full overflow-x-scroll overflow-y-hidden rounded-xl border border-border bg-surface;
    scrollbar-gutter: stable both-edges;
  }

  .attendees-table {
    @apply min-w-[1100px] bg-surface text-sm;
  }

  .attendees-table thead th {
    @apply sticky top-0 z-[2] bg-surface-elevated align-top text-xs font-semibold uppercase tracking-wide text-muted;
  }

  .attendees-table td {
    @apply text-sm text-text;
  }

  .attendees-table.compact th,
  .attendees-table.compact td {
    @apply px-2 py-1.5 text-xs;
  }

  .attendees-table tbody tr {
    @apply cursor-pointer transition-colors hover:bg-surface-elevated;
  }

  .attendees-table tbody tr:nth-child(even) {
    @apply bg-surface/70;
  }

  .th-clamp {
    @apply block min-w-[96px] normal-case tracking-normal text-xs text-text;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .attendees-col-drag {
    @apply min-w-[76px];
  }

  .attendees-col-color {
    @apply min-w-[96px];
  }

  .attendees-col-name {
    @apply min-w-[170px];
  }

  .attendees-col-username {
    @apply min-w-[140px];
  }

  .sticky-col-1,
  .sticky-col-2,
  .sticky-col-3 {
    @apply sticky z-[1] bg-surface;
  }

  .sticky-col-1 {
    left: 0;
  }

  .sticky-col-2 {
    left: 76px;
  }

  .sticky-col-3 {
    left: 224px;
  }

  .attendees-table tbody tr:hover .sticky-col-1,
  .attendees-table tbody tr:hover .sticky-col-2,
  .attendees-table tbody tr:hover .sticky-col-3 {
    @apply bg-surface-elevated;
  }

  .attendees-row-dragging {
    @apply opacity-60;
  }

  .drag-handle {
    @apply rounded-md border border-border bg-surface px-2 py-1 text-xs;
    cursor: grab;
  }

  .row-color-controls {
    @apply grid min-w-[76px] gap-1;
  }

  .row-color-controls input[type="color"] {
    @apply h-7 w-9 rounded border border-border bg-surface p-0;
  }

  .row-color-clear {
    @apply h-auto w-fit rounded border border-border px-2 py-1 text-xs;
  }

  .attendees-order-message {
    @apply mb-2 rounded-lg border px-3 py-2 text-sm;
  }

  .attendees-order-message.ok {
    @apply border-success/50 bg-success/10 text-success;
  }

  .attendees-order-message.error {
    @apply border-danger/50 bg-danger/10 text-danger;
  }

  .attendees-order-message.info {
    @apply border-border bg-surface-elevated text-muted;
  }

  .attendee-drawer-overlay {
    @apply fixed inset-0 z-30 flex justify-end bg-slate-950/50 backdrop-blur-sm;
  }

  .attendee-drawer {
    @apply h-screen w-full max-w-[520px] overflow-y-auto border-l border-border bg-surface p-5 shadow-panel;
    animation: slide-in 180ms ease-out;
  }

  .attendee-drawer-header {
    @apply mb-3 flex items-center justify-between gap-2;
  }

  .attendee-drawer-meta p {
    @apply my-1 text-sm;
  }

  .markdown-preview {
    @apply mt-3 rounded-xl border border-border bg-surface-elevated p-4;
  }

  .markdown-preview p,
  .markdown-preview h2,
  .markdown-preview h3,
  .markdown-preview h4,
  .markdown-preview ul {
    @apply my-2;
  }

  .markdown-preview code {
    @apply rounded bg-bg px-1 py-0.5 text-xs;
  }
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}
